angular.module("app").controller("sensorAttribute",["$scope","$uibModalInstance","$q","SensorSUID","ProjectID","Driver","API","Control","SensorAttrib",function(e,r,i,t,n,o,c,d,a){function s(){return e.drivercompanySelected&&e.driverNameSelected&&e.driverVersionSelected?e.drivercompanySelected+"/"+e.driverNameSelected+"/"+e.driverVersionSelected:""}function v(r,i){var n={command:"EMC_VIEW_ADAPTDEVICE",sid:t,driver:r};c.Query(d.Send,n,function(r){console.log(r),r.err||(e.AdaptDevice=[],_.each(r.result,function(r,i){var t=r;e.AdaptDevice.push(t)}),i?e.adaptDeviceSelected=i:e.AdaptDevice.length&&(e.adaptDeviceSelected=e.AdaptDevice[0].code))})}e.Ok=function(){var i=s();if(!i.length)return void r.close();var o={_id:t,driver:i,project:n,ext:e.SensorAttrib.ext||{}};o.ext.adaptdevice=e.adaptDeviceSelected||"",c.Query(a.update,o,function(e){e.err,r.close()})},e.Cancel=function(){r.dismiss("cancel")},e.$watch("drivercompanySelected",function(r){if(r){if(e.DriverNames=e.Drivers[r].driver,!e.DriverNames)return;e.DriverName=[],_.map(e.DriverNames,function(r,i){e.DriverName.push({id:i})})}}),e.$watch("driverNameSelected",function(r){if(r){if(e.DriverVersions=e.DriverNames[r].driver,!e.DriverVersions)return;e.DriverVersion=[],_.map(e.DriverVersions,function(r,i){e.DriverVersion.push({id:i})})}}),e.$watch("driverVersionSelected",function(e){if(e){var r=s();if(!r.length)return;v(r)}}),i.all([c.QueryPromise(o.enum,{}).$promise,c.QueryPromise(a.info,{sensor:t}).$promise]).then(function(r){if(e.Drivers=r[0].result,e.DriverCompany=[],_.map(e.Drivers,function(r,i){e.DriverCompany.push({id:i})}),e.SensorAttrib=r[1].result||{},e.SensorAttrib){if(e.SensorAttrib.driver){var i=e.SensorAttrib.driver.split("/");e.drivercompanySelected=i[0],e.driverNameSelected=i[1],e.driverVersionSelected=i[2]}var t=null;t=e.SensorAttrib.ext&&e.SensorAttrib.ext.adaptdevice,v(e.SensorAttrib.driver,t)}})}]);
//# sourceMappingURL=sensorAttribute.min.js.map
