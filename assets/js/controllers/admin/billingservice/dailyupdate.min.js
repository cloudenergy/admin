angular.module("app").component("dailyUpdate",{templateUrl:"assets/html/admin/billingservice/dailyupdate.html?rev=7f3acd6171",controller:["$scope","$element","$api","$stateParams","$state",function(e,t,l,a,c){var n=this;n.annual=!0,n.effectGenre=[{title:"物业费",value:"PAYPROPERTY"},{title:"停车费",value:"PAYPARKING"},{title:"空调费",value:"PAYAIRCONDITIONER"}],n.effectGenre.selected={value:n.effectGenre[0].value},n.unit=[{title:"日",value:"day"},{title:"月",value:"month"},{title:"户",value:"ONCE"}],n.unit.selected={value:n.unit[0].value},n.cycle=[{title:"年",value:"0"},{title:"半年",value:"2"},{title:"季度",value:"1"},{title:"月",value:"month"}],e.$watch("$ctrl.unit.selected.value",function(e){n.annual="ONCE"==e||n.annual}),e.$watch("$ctrl.annual",function(){n.disabled=!n.annual,n.cycle.selected={value:n.annual&&n.cycle[0].value||n.cycle[3].value}}),l.packageplan.info({project:EMAPP.Project.selected._id,id:a.id},function(e){e=e.result,n.serviceTitle=e.title,n.price=e.rent.price,n.unit.selected.value=e.rent.freq,n.effectGenre.selected.value=e.type,n.cycle.selected.value=e.strategy[0].flag.toString(),n.day=e.strategy[0].day,n.from=e.strategy[0].validfrom,n.to=e.strategy[0].validto,n.annual=0==n.from}),n.submit=function(){l.packageplan.update({project:EMAPP.Project.selected._id,id:a.id,title:n.serviceTitle,rent:{mode:"ARER",price:parseInt(n.price),freq:n.unit.selected.value},type:n.effectGenre.selected.value,strategy:[{flag:"month"!=n.cycle.selected.value?parseInt(n.cycle.selected.value):void 0,month:"month"==n.cycle.selected.value?0:void 0,day:parseInt(n.day),hour:8,minute:0,validfrom:"ONCE"!=n.cycle.selected?!n.annual&&parseInt(n.from)||void 0:void 0,validto:"ONCE"!=n.cycle.selected?!n.annual&&parseInt(n.to)||void 0:void 0}]},function(){c.go("admin.billingservice.dailyinfo")})}}]});