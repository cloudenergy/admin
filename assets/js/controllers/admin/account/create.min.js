angular.module("app").controller("accountCreate",["$scope","$q","$state","$cookies","BillingAccount","Account","API","Auth","UI","Character",function(e,r,c,t,n,a,o,s,u,i){s.Check(function(){e.warning={},e.submit=function(r){return e.account.user.length<6?void u.AlertError("用户名不能低于6位"):e.newpasswd!=e.repeatnewpasswd?void u.AlertError("二次密码输入不一致，请重新输入"):(void 0!=e.newpasswd||null!=e.newpasswd,e.characters.selected?(e.account.character=e.characters.selected._id,e.account.message=Object.keys(e.warning).filter(function(r){return e.warning[r]?r:""}).join(","),void o.Query(n.add,{account:e.account.user,title:e.account.user},function(r){r.code?u.AlertError(r.message):(e.account.billingAccount=r.result._id,console.log(e.account),o.Query(a.add,e.account,function(e){console.log(e),e.code?u.AlertError("账户创建错误: "+e.message):(u.AlertSuccess("创建账户成功"),c.go("admin.account.info"))}))})):void u.AlertError("请选择创建账户的权限级别"))},o.Query(a.info,{id:t.user},function(r){if(r.code)u.AlertError(result.message);else{e.adminUser=r.result;var c=e.adminUser.character&&e.adminUser.character.level;o.Query(i.info,{power:c},function(r){r.code?u.AlertError(r.message):(e.characters=r.result,e.characters.selected=e.characters[e.characters.length-1])})}})})}]);
//# sourceMappingURL=create.min.js.map
