angular.module("app").controller("accountEdit",["$scope","$stateParams","$q","$state","Account","API","Auth","UI","Character",function(e,r,a,c,t,n,i,o,s){i.Check(function(){e.submit=function(r){var a={_id:e.account._id};return e.newpasswd!=e.repeatnewpasswd?void o.AlertError("二次密码输入不一致，请重新输入"):(e.newpasswd&&e.newpasswd.length,e.characters.level?(a.character=e.characters.level._id,a.title=e.account.title,a.mobile=e.account.mobile,a.email=e.account.email,a.message=Object.keys(e.warning).filter(function(r){return e.warning[r]?r:""}).join(","),e.account.initpath&&(a.initpath=e.account.initpath),void n.Query(t.update,a,function(e){o.AlertSuccess("账户更新成功"),c.go("admin.account.info")},function(e){e.code&&o.AlertError(e.message)})):void o.AlertError("请选择创建账户的权限级别"))},a.all([n.QueryPromise(t.info,{id:EMAPP.Account._id}).$promise,n.QueryPromise(t.info,{id:r.id}).$promise]).then(function(r){e.adminUser=r[0].result,e.account=r[1].result;var a=e.account.message?e.account.message.split(","):[];e.warning={},angular.forEach(a,function(r,a){e.warning[r]=!0});var c=e.adminUser.character&&e.adminUser.character.level;n.Query(s.info,{power:c},function(r){r.code?o.AlertError(r.message):(e.characters=r.result,e.characters.level=e.account.character&&e.account.character.level,void 0==e.characters.level?e.characters.level=e.characters[e.characters.length-1]:e.characters.level=_.find(e.characters,function(r){return r.level==e.characters.level}))})})})}]);
//# sourceMappingURL=edit.min.js.map
