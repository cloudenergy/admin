angular.module("app").controller("login",["$api","$cookies","$state","UI","md5",function(o,e,t,r,n){var a,s=this,i=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname,u=function(o){o=o&&o.result||{},angular.forEach(["token","user"],function(t){o[t]&&e.put(t,o[t],{path:"/",domain:i,expires:a&&moment().add(1,"months")._d||void 0})}),o.token?t.go("admin.dashboard"):(t.go("login"),r.AlertError(o.message,"登录失败"))};s.login=function(){var e=this&&this.user,t=this&&this.password,i=[];a=s.remember,!e&&i.push("帐号"),!t&&i.push("密码"),i=i.join("与"),i&&r.AlertError("请输入您的"+i),!i&&o.auth.login({user:e,passwd:n.createHash(t).toUpperCase()},u,function(o){r.AlertError("服务器错误","错误: "+o.data.code)})}}]);