angular.module("app").controller("login",["$api","$cookies","$state","UI","md5","$scope",function(e,r,o,t,a,n){var m,c=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname,s=function(e){e=e&&e.result||{},angular.forEach(["token","uid","user"],function(o){e[o]&&r.put(o,e[o],{path:"/",domain:c,expires:m&&moment().add(1,"months")._d||void 0})}),e.token?o.go("admin.dashboard"):(o.go("login"),t.AlertError(e.message,"登录失败"))};n.user=localStorage.user,n.$watch("rememberaccount",function(){n.rememberaccount?"":n.remember=n.rememberaccount}),n.$watch("remember",function(){n.remember?n.rememberaccount=n.remember:""}),n.login=function(){var r=this&&this.user,o=this&&this.password,c=[];m=n.remember,n.rememberaccount?localStorage.user=r:"",!r&&c.push("帐号"),!o&&c.push("密码"),c=c.join("与"),c&&t.AlertError("请输入您的"+c),!c&&e.auth.login({user:r,passwd:a.createHash(o).toUpperCase()},s,function(e){t.AlertError("服务器错误","错误: "+e.data.code)})}}]);