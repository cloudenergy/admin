<div class="row"><div class="col-md-12"><div class="panel panel-default"><div class="panel-body"><div class="form-inline mb15"><div class="form-group mr15" ng-if="projects.length"><select ng-model="projects.selected" ng-options="project._id as project.title for project in projects" ui-jq="chosen" ui-options="{disable_search_threshold:10,width:'222px'}"></select></div><div class="form-group" ng-if="statusenum.length"><select ng-model="statusenum.selected" ng-options="status.id as status.title for status in statusenum" ui-jq="chosen" ui-options="{disable_search_threshold:10,width:'auto'}"></select></div><div class="form-group pull-right"><a class="btn btn-sm btn-primary" href="/admin/department/create/{{projects.selected}}" ng-show="operateStatus.create.isEnable"><i class="glyphicon glyphicon-plus"></i> 添加户 </a><a class="btn btn-sm btn-info ml5" href="javascript:void(0)" ng-click="OnImportDepartment()"><i class="glyphicon glyphicon-import"></i> 导入商户 </a><a class="btn btn-sm btn-warning ml5" href="javascript:void(0)" ng-click="OnBatchRecharge()"><i class="glyphicon glyphicon-usd"></i> 批量充值</a></div></div><form class="form-inline mb15" ng-submit="GetDepartment()"><label class="mr5">余额小于</label><input type="text" class="form-control mr15" placeholder="输入账户余额数值" ng-model="filterAmount"><label class="mr5">关键字</label><input type="text" class="form-control" placeholder="商户,账户,传感器名称" ng-model="departmentKey"> <button type="submit" class="btn btn-sm btn-info"><span class="glyphicon glyphicon-search"></span> 查询</button><div class="pull-right" ng-if="paging.size"><label>每页显示：</label><select ng-model="paging.size" ng-options="val as val for (key,val) in [10,15,30,50,100]" ui-jq="chosen" ui-options="{disable_search_threshold:10,width:'auto'}"></select></div></form><table class="table table-hover table-bordered mb0"><thead><tr><th class="text-center" style="width:60px">序号</th><th>商户名称</th><th>商户账户</th><th>面积</th><th>传感器<span class="pull-right">开/关</span></th><th>余额</th><th class="text-center" style="width:60px">状态</th><th class="text-center" style="width:220px">操作</th></tr></thead><tbody><tr ng-repeat="department in listData"><td class="text-center" ng-bind="(listData.index-1)*paging.size+$index+1"></td><td style="white-space:nowrap">{{department.title}}</td><td>{{department.account._id}}</td><td style="white-space:nowrap">{{department.area}} <small>m2</small></td><td data-hint="{{department.sensorAll}}" style="line-height: 24px"><div class="clearfix" ng-repeat="sensor in department.sensors" ng-class="{'bb': !$last, pt2: !$first}">ID：{{sensor.addrid}}&nbsp;&nbsp; 名称：{{sensor.title}}<label class="switch switch-sm pull-right mb0"><input type="checkbox" ng-model="sensor.status.switch" ng-click="switchControl(sensor)"> <span><i class="handle"></i></span></label></div></td><td ng-class="{'text-danger':department.account.billingAccount.cash<0}">{{department.account.billingAccount.cash}}</td><th class="text-center" ng-class="{'text-danger':department.account.billingAccount.cash<0}">{{department.status}}</th><td class="text-center" style="font-size:12px;white-space:nowrap"><a class="mr10" ui-sref="admin.account.amount({account:department.account._id,redirect:ChargeRedirect,project:projects.selected})" ng-show="operateStatus.edit.isEnable"><i class="glyphicon glyphicon-usd"></i>充值 </a><a class="mr10" href="/admin/department/edit/{{department._id}}" ng-show="operateStatus.edit.isEnable"><i class="glyphicon glyphicon-edit"></i>编辑 </a><a href="javascript:void(0)" ng-click="askingRemoveID=department._id" ng-show="department._id!==askingRemoveID && operateStatus.edit.isEnable"><span><i class="glyphicon glyphicon-trash"></i>删除</span> </a><a class="text-warning mr5" href="javascript:void(0)" ng-show="department._id===askingRemoveID" ng-click="askingRemoveID=0"><i class="glyphicon glyphicon-remove"></i>取消</a> <a class="text-danger" href="javascript:void(0)" ng-show="department._id===askingRemoveID" ng-click="DoRemove(department._id)"><i class="glyphicon glyphicon-ok"></i>确定</a></td></tr></tbody></table><uib-pagination class="pagination-sm pull-right mt15 mb0" total-items="listData.total" ng-model="paging.index" items-per-page="paging.size" max-size="10" rotate="false" boundary-links="true" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></uib-pagination></div></div></div></div><script type="text/ng-template" id="import_department.html"><form class="container-fluid" action="{{actionURL}}" ng-upload="OnUploadComplete(content)">
        <div class="text-center bb no-margin p10 h3">
            导入商户
        </div>
        <div class="pt15 pb15">
            <input type="file" name="avatar" required />
            <input type="hidden" name="projectid" value="{{ProjectID}}" />
            <input type="hidden" name="character" value="{{Character}}" />
        </div>
        <div class="text-right pb15">
            <a class="pull-left mt5 text-primary bold" target="_blank" href="/files/商户帐号导入模板.xlsx">默认模板下载</a>
            <button type="submit" class="btn btn-sm btn-primary mr5" ng-disabled="$isUploading">上传</button>
            <button type="button" class="btn btn-sm btn-warning" ng-click="OnCancel()">取消</button>
        </div>
    </form></script><script type="text/ng-template" id="batch_recharge.html"><form class="container-fluid" action="{{actionURL}}" ng-upload="OnUploadComplete(content)">
        <div class="text-center bb no-margin p10 h3">
            批量充值
        </div>
        <div class="pt15 pb15">
            <input type="file" name="batchrecharge" required />
            <input type="hidden" name="projectid" value="{{ProjectID}}" />
            <div class="mt15" ng-if="downloadLink">
                (点击下载<a target="_blank" ng-href="{{downloadLink}}" class="text-primary">充值回单<i class="glyphicon glyphicon-download-alt"></i></a>)
            </div>
        </div>
        <div class="text-right pb15">
            <a class="pull-left mt5 text-primary bold" target="_blank" href="/files/帐号批量充值模板.xlsx">默认模板下载</a>
            <button type="submit" class="btn btn-sm btn-primary mr5" ng-disabled="$isUploading">上传</button>
            <button type="button" class="btn btn-sm btn-warning" ng-click="OnCancel()">取消</button>
        </div>
    </form></script><script type="text/ng-template" id="switch_control.html"><div class="container-fluid">
        <div class="text-center bb no-margin p10 h3">
            验证操作
        </div>
        <div class="pt15 pb15">
            <div class="input-group">
                <div class="input-group-addon">密码</div>
                <input type="password" class="form-control" placeholder="请输入密码" ng-model="password" required>
            </div>
        </div>
        <div class="text-right pb15">
            <button class="btn btn-sm btn-primary mr5" ng-click="OnSubmit()">验证</button>
            <button class="btn btn-sm btn-warning" ng-click="OnCancel()">取消</button>
        </div>
    </div></script>