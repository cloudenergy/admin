angular.module("app").controller("admin",["$scope","$rootScope","$cookies","$q","$state","$localStorage","$api",function(e,t,a,i,o,n,r){var c=this,l={dashboard:"home",character:"user",project:"archive",account:"briefcase",billingservice:"calculator",urlpath:"compass",building:"building",department:"diamond",customer:"yen",eventcategory:"envelope",energycategory:"database",energy:"fire",sensor:"dashboard",collector:"tasks",appidsecret:"eye",finance:"dollar",property:"dollar"},s=[{title:"首页",state:"admin.dashboard",ignore:!0},{title:"角色管理",state:"admin.character.info"},{title:"项目管理",state:"admin.project.info"},{title:"APPID.SECRET",state:"admin.appidsecret.info"},{title:"账户管理",state:"admin.account.info"},{title:"计费策略",state:"admin.billingservice.info"},{title:"地址管理",state:"admin.urlpath.info"},{title:"建筑管理",state:"admin.building.info"},{title:"户管理",state:"admin.department.info"},{title:"社会属性",state:"admin.customer.index"},{title:"采集器管理",state:"admin.collector.info"},{title:"能耗配置",state:"admin.energycategory.info"},{title:"能耗分类",state:"admin.energy.index"},{title:"传感器管理",state:"admin.sensor.info"},{title:"事件配置",state:"admin.eventcategory.info"},{title:"平台财务",state:"admin.finance.index"},{title:"物业财务",state:"admin.property.index"}],d=[];c.layoutLoaded={},c.app={name:document.title,year:(new Date).getFullYear(),layout:{isSmallSidebar:!1,isChatOpen:!1,isFixedHeader:!0,isFixedFooter:!1,isBoxed:!1,isStaticSidebar:!1,isRightSidebar:!1,isOffscreenOpen:!1,isConversationOpen:!1,isQuickLaunch:!1,sidebarTheme:"",headerTheme:""},isMessageOpen:!1,isConfigOpen:!1},e.user={avatar:"images/avatar.jpg",name:a.get("user")},e.wwwLink=location.origin.replace("preadmin.","pre.").replace("admin.","www."),n.layout?c.app.layout=n.layout:n.layout=c.app.layout,e.$watch("self.app.layout",function(){n.layout=c.app.layout}),e.$on("$includeContentRequested",function(e,t){/^templates\/common/.test(t)&&(c.layoutLoaded[t]=i.defer(),d.push(c.layoutLoaded[t].promise))}),e.$on("$includeContentLoaded",function(e,t){/^templates\/common/.test(t)&&c.layoutLoaded[t]&&c.layoutLoaded[t].resolve()}),i.all(d.concat([r.account.info({id:a.get("user")},function(e){EMAPP.Account=e.result||{},EMAPP.Rule={},function t(e,a,i){angular.forEach(e,function(e,o){"leaf"!==o&&(0===a?t(e,a+1,[o]):e.leaf?EMAPP.Rule[i.concat([o]).join(".")]=!0:t(e,a+1,i.concat([o])))})}(EMAPP.Account.character.rule["/"],0),angular.forEach(s,function(e){(e.ignore||EMAPP.Rule[e.state])&&(e.prefix=/^(\w+\.\w+)?/.exec(e.state)[0]||"",e.icon=l[e.state.split(".")[1]]||"circle",this.push(e))},c.menu=[])}).$promise,r.project.info(function(e){EMAPP.Project=angular.isArray(e.result)?e.result:e.result&&[e.result]||[]}).$promise])).then(function(){if(EMAPP.Project.length){var e=EMAPP.Account._id+"_root_project_selected",a=n[e];angular.forEach(EMAPP.Project,function(e){EMAPP.Project[e._id]=e,a===e._id&&(EMAPP.Project.selected=e)}),EMAPP.Project.selected=EMAPP.Project.selected||EMAPP.Project[0]||{},t.Project=EMAPP.Project,t.$watch("Project.selected",function(t){n[e]=t._id}),c.layoutLoaded=!0}})}]);
//# sourceMappingURL=admin.min.js.map
