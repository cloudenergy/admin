angular.module("app").controller("Property.statement",["$scope","$api","$state","$stateParams","$timeout","$q",function(t,e,i,n,a,l){var o=this,r=EMAPP.Account._id+"_property_statement_pagesize";o.tab=n.tab||"daily",o.format="daily"===o.tab?"YYYY-MM":"YYYY",o.viewDate=moment().format(o.format),t.$watch(function(){return o.viewDate},function(t){o.listData&&o.list()}),t.$watch(function(){return o.paging.index},function(){o.listData&&o.list()}),t.$watch(function(){return o.paging.size},function(t){localStorage.setItem(r,t),o.listData&&o.list()}),t.$watch("Project.selected",function(t){o.projectid=t._id,o.list()}),o.paging={index:1,size:parseInt(localStorage.getItem(r)||10),items:[{key:10,title:"每页10条"},{key:15,title:"每页15条"},{key:30,title:"每页30条"},{key:50,title:"每页50条"},{key:100,title:"每页100条"}]},o.list=function(){e.business[o.tab+"fundsummary"]({project:o.projectid,time:o.viewDate.replace(/\-/g,""),pageindex:o.paging.index,pagesize:o.paging.size},function(t){t=t.result||{},angular.forEach(t.detail,function(t){Object.keys(t.earning).length||Object.keys(t.expenses).length||Object.keys(t.projectbalance).length||Object.keys(t.consumption).length||Object.keys(t.departmentbalance).length||(t.isnull=!0)}),o.listData=t.detail||[],o.listData.index=(t.paging||{}).pageindex||1,o.listData.total=(t.paging||{}).count||0})},o.exportBill=function(t){delete t.downloadFileBill,"daily"===o.tab?e["export"].projectdailybill({project:o.projectid,time:t.time},function(e){e.result.fn&&(t.downloadFileBill=e.result.fn,t.downloadNameBill=o.projectname+"_"+i.$current.data.title+"_日账单_"+t.time)}):e["export"].projectmonthlybill({project:o.projectid,time:t.time},function(e){e.result.fn&&(t.downloadFileBill=e.result.fn,t.downloadNameBill=o.projectname+"_"+i.$current.data.title+"_月账单_"+t.time)})},o.exportReceipt=function(t){delete t.downloadFileReceipt,"daily"===o.tab?e["export"].projectdailyreceipt({project:o.projectid,time:t.time},function(e){e.result.fn&&(t.downloadFileReceipt=e.result.fn,t.downloadNameReceipt=o.projectname+"_"+i.$current.data.title+"_日回单_"+t.time)}):e["export"].projectmonthlyreceipt({project:o.projectid,time:t.time},function(e){e.result.fn&&(t.downloadFileReceipt=e.result.fn,t.downloadNameReceipt=o.projectname+"_"+i.$current.data.title+"_月回单_"+t.time)})}}]);
//# sourceMappingURL=statement.min.js.map
