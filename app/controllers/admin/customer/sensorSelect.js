EMAPP.register.controller("SensorSelect",["$scope","$rootScope","$uibModalInstance","$api","ProjectID","SelectKEY",function(e,n,i,a,r,s){var o,t,c=function(){a.sensor.info({project:r,keyreg:e.sensorSearchKey,pageindex:e.currentPage,pagesize:n.popPageSize},function(n){angular.forEach(o=n.result.detail||[],function(e){o[e.id]=e.id}),e.pagingCount=n.result.paging.count,e.UpdateViewOfSensors()})};e.currentPage=1,e.Submit=function(){i.close(s)},e.Cancel=function(){i.dismiss("cancel")},e.switchSensor=function(e,n){(e.isEnable=n||!e.isEnable)?0===s[e.id]?s[e.id]=1:angular.isUndefined(s[e.id])&&(s[e.id]=e.title):1===s[e.id]?s[e.id]=0:delete s[e.id]},e.searchSensor=function(n){(n||!angular.equals(t,e.sensorSearchKey))&&c(),t=e.sensorSearchKey},e.selectAll=function(){angular.forEach(e.viewOfSensors,function(n){e.switchSensor(n,!0)})},e.UpdateViewOfSensors=function(n){e.viewOfSensors=[],angular.forEach(o,function(i){i.isEnable=!!s[i.id],(angular.isUndefined(n)||i.id.match(n)||i.title.match(n))&&e.viewOfSensors.push(i)})},e.$watch("currentPage",c)}]);