angular.module("app").controller("sessionCtrl",["$api","$cookies","$state","UI","md5",function(e,t,s,o,r){var n=this,a=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname,i=function(e){EMAPP.User=e&&e.result||EMAPP.User||{},angular.forEach(["token","user"],function(e){EMAPP.User[e]&&t.put(e,EMAPP.User[e]||!1,{path:"/",domain:a,expires:new Date((new Date).setMonth((new Date).getMonth()+1))})}),EMAPP.User.token?s.go("admin.dashboard"):(s.go("user.signin"),o.AlertError(e.message,"登录失败"))};n.login=function(){var t=this&&this.user,s=this&&this.passwd,n=[];!t&&n.push("帐号"),!s&&n.push("密码"),n=n.join("与"),n&&o.AlertError("请输入您的"+n),!n&&e.auth.login({user:t,passwd:r.createHash(s).toUpperCase()},i,function(e){o.AlertError("服务器错误","错误: "+e.data.code)})}}]);