<style>.pane-statistic {
        background-color: #e5eefa;
    }

    .pane-statistic span,
    .pane-statistic a {
        font-size: 16px;
    }</style><form class="form-inline" ng-submit="self.list()"><div class="form-group w150 ng-hide" ng-show="self.category"><ui-select ng-model="self.category.selected" search-enabled="false" remove-selected="false"><ui-select-match placeholder="选择类型">{{$select.selected.title}}</ui-select-match><ui-select-choices repeat="item.key as item in self.category"><div ng-bind-html="item.title"></div></ui-select-choices></ui-select></div><div class="form-group has-feedback date w150 ml5 toggle-active"><input type="text" class="form-control" ng-model="self.startDate" datetimepicker="{maxRangeTo:'#end_date',rangeDay:31}" id="start_date"> <span class="form-control-feedback"><i class="fa fa-calendar"></i></span></div><div class="form-group"><i class="glyphicon glyphicon-minus"></i></div><div class="form-group has-feedback date w150 toggle-active"><input type="text" class="form-control" ng-model="self.endDate" datetimepicker="{minRangeTo:'#start_date',rangeDay:31}" id="end_date"> <span class="form-control-feedback"><i class="fa fa-calendar"></i></span></div><div class="input-group w250 ml10"><span class="input-group-addon pl5 pr5">名称/账号</span> <input type="text" class="form-control" ng-model="self.searchText"></div><div class="input-group ml10"><button type="submit" class="btn btn-sm btn-primary"><i class="fa fa-search"></i> 查询</button></div><div class="input-group ml10 pull-right"><a href="javascript:void(0)" class="btn btn-sm btn-primary" modal-download="self.downloadFile" modal-download-name="self.downloadName" ng-click="self.exportConsumptiondetail()"><i class="fa fa-file-text-o"></i> 导出</a></div></form><div class="panel mt10 mb0"><div class="panel-body"><div class="relative col-xs-12 overflow-hidden no-padding mb15" perfect-scrollbar="!!self.listData"><div class="form-inline pane-statistic pl15 pr15 pt10 pb10"><div class="form-group">消耗金额：</div><div class="form-group ml10 mr10"><span class="text-danger" ng-bind="self.statistic.consumption.sum||0"></span> <small class="text-muted">(元)</small></div><div class="form-group ml30">充值金额：</div><div class="form-group ml10 mr10"><a ui-sref="admin.property.record({tab:'in'})" class="text-success" ng-bind="self.statistic.earning.sum||0"></a> <small class="text-muted">(元)</small></div><div class="form-group ml30">当前余额：</div><div class="form-group ml10">期初</div><div class="form-group ml5"><span class="text-primary" ng-bind="self.statistic.balance.from||0"></span> <small class="text-muted">(元)</small></div><div class="form-group ml15">期末</div><div class="form-group ml5"><span class="text-primary" ng-bind="self.statistic.balance.to||0"></span> <small class="text-muted">(元)</small></div></div><table class="table table-hover table-nowrap bb no-margin nowrap"><thead><tr><th style="width:80px;">序号</th><th>商户名称</th><th>商户账号</th><th class="no-padding" style="width:20px;"></th><th style="min-width:230px;max-width:300px;">充值金额</th><th style="min-width:230px;max-width:300px;">消耗金额</th><th>商户余额</th></tr></thead><tbody><tr ng-repeat="item in self.listData" ng-class="{active:self.listData.collapsed===item.key}"><td ng-bind="(self.listData.index-1)*self.paging.size+$index+1"></td><td ng-bind="item.title"></td><td ng-bind="item.account"></td><td class="no-padding"><a href="javascript:void(0)" class="emfinance text-muted h4 block mb0 mt10 toggle-active" ng-if="!item.isnull" ng-class="{true:'finance-down',false:'finance-right'}[self.listData.collapsed===item.key]" ng-click="self.listData.collapsed=(self.listData.collapsed===item.key?null:(item.isnull||item.key))"></a></td><td class="text-success"><a class="h4 no-margin text-success" ng-bind="item.earning.sum||'-'" target="_blank" ng-href="{{$root.wwwLink+'/dashboard'+$root.Project.selected._id+'/financial/all|nearest|'+item.account+'|'+self.startDate+'|'+self.endDate}}"></a><div class="mt5" uib-collapse="self.listData.collapsed!==item.key" ng-if="item.earning.category"><ul class="list-group no-margin"><li class="list-group-item p5 clearfix" ng-repeat="item in item.earning.category"><div class="pull-left" ng-bind="item.name"></div><div class="pull-right"><span class="text-success mr10" ng-bind="item.amount"></span> <span class="text-muted">{{item.count}} 笔</span></div></li></ul></div></td><td class="text-danger"><a class="h4 no-margin text-danger" ng-bind="item.consumption.sum||'-'" target="_blank" ng-href="{{$root.wwwLink+'/dashboard'+$root.Project.selected._id+'/financial/all|usage|'+item.account+'|'+self.startDate+'|'+self.endDate}}"></a><div class="mt5" uib-collapse="self.listData.collapsed!==item.key" ng-if="item.consumption.category"><ul class="list-group no-margin"><li class="list-group-item p5 clearfix" ng-repeat="item in item.consumption.category"><div class="pull-left" ng-bind="item.name"></div><div class="pull-right text-primary" ng-bind="item.amount"></div></li></ul></div></td><td><div><span class="text-muted">期初：</span><span class="h5 no-margin text-green" ng-bind="item.balance.from||'-'"></span></div><div><span class="text-muted">期末：</span><span class="h5 no-margin text-orange" ng-bind="item.balance.to||'-'"></span></div></td></tr></tbody></table></div><div class="pull-left"><ui-select style="width:110px;" ng-model="self.paging.size" search-enabled="false" remove-selected="false"><ui-select-match placeholder="每页条目">{{$select.selected.title}}</ui-select-match><ui-select-choices position="up" repeat="item.key as item in self.paging.items"><div ng-bind-html="item.title"></div></ui-select-choices></ui-select></div><ul uib-pagination class="pull-right mt0 mb0" total-items="self.listData.total" ng-model="self.paging.index" items-per-page="self.paging.size" max-size="10" rotate="false" boundary-links="true" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></ul></div></div>