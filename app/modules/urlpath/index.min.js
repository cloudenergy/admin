"use strict";angular.module("app").controller("urlpathInfo",["$scope","$api","Auth","UI",function(e,n,t,i){var d,o=[];t.Check(function(){e.doSave=function(t){function i(e,n){if("/"!=e._id&&(n+=e._id),void 0!=e.authtype){var t={_id:e._id,desc:e.desc,authtype:e.authtype,needlogin:e.needlogin,enable:e.enable};t._id=n,d.push(t)}void 0!=e.nodes&&e.nodes.length>0&&_.each(e.nodes,function(e){i(e,n+"/")})}t.preventDefault();var d=[];i(e.urlpath[0],"");var u=[];_.each(o,function(e){u.push(e.url._id)}),n.urlpath.delete({id:u}),n.urlpath.delete({id:u}),n.urlpath.update(d)},n.urlpath.info(function(n){d=n.result;var t={_id:"/",nodes:[]};_.each(d,function(e){var n=e._id.split("/"),i=t;_.each(n,function(t,d){if(""!=t){var o=n.length==d+1,u=_.find(i.nodes,function(e){return e._id==t});void 0==u&&(u=o?{_id:t,url:e,desc:e.desc||"",enable:e.enable,needlogin:e.needlogin,authtype:e.authtype,nodes:[]}:{_id:t,desc:e.desc||"",nodes:[]},i.nodes.push(u)),i=u}})}),e.urlpath=[t]},function(e){i.AlertError(e.message)}),e.RemoveNode=function(e,n){e.remove(),o.push(n)},e.enable=function(e){e.enable=!e.enable},e.toggle=function(e){e.toggle()},e.newSubItem=function(e){var n=e.node;n.nodes.push({_id:"",authtype:"NONE",needlogin:!0,enable:!0,editing:!0,isnew:!0,nodes:[]})},e.edit=function(e){e.editing=!0},e.needLogin=function(e){e.needlogin=!e.needlogin},e.SetAuthType=function(e,n){e.authtype=n},e.cancelEditing=function(n,t){t._id.length?t.editing=!1:e.RemoveNode(n,t)},e.save=function(e){e.editing=!1,e.isnew=!1}})}]);