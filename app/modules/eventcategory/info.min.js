"use strict";angular.module("app").controller("eventcategoryIndex",["$rootScope","$scope","$api","SweetAlert",function(e,o,t,n){t.message.list({projectid:e.Project.selected._id},function(e){o.Eventcategory=e.result,o.Eventcategory.eventShow=[],angular.forEach(o.Eventcategory,function(e,t){o.Eventcategory.eventShow[t]=[],o.Eventcategory.eventShow[t].title=e.title,angular.forEach(e,function(n,a){var l={name:a,value:n,mid:e.mid};"title"!=l.name&&"mid"!=l.name&&o.Eventcategory.eventShow[t].push(l)}),"欠费停止服务"==e.title&&(e.stop=!0)})}).$promise.then(function(){console.log(o.Eventcategory),o.loaddata=function(){t.moduleevent.info({projectid:e.Project.selected._id},function(e){e=e.result,o.originAUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&angular.copy(e.AUTOTURNOFF)||{threshold:0},o.AUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&e.AUTOTURNOFF||{threshold:0},o.$watch("AUTOTURNOFF.threshold",function(e){o.AUTOTURNOFF.threshold!=(o.originAUTOTURNOFF&&o.originAUTOTURNOFF.threshold)&&(o.showThreshold=!0)||(o.showThreshold=!1)})},function(e){e=e.result,o.originAUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&angular.copy(e.AUTOTURNOFF)||{threshold:0},o.AUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&e.AUTOTURNOFF||{threshold:0},o.$watch("AUTOTURNOFF.threshold",function(e){console.log(o.AUTOTURNOFF,o.originAUTOTURNOFF.threshold),o.AUTOTURNOFF.threshold!=(o.originAUTOTURNOFF&&o.originAUTOTURNOFF.threshold)&&(o.showThreshold=!0)||(o.showThreshold=!1)})})},o.loaddata()}),o.switch=function(){t.moduleevent.update({projectid:e.Project.selected._id,modules:{AUTOTURNOFF:{switch:o.AUTOTURNOFF&&o.AUTOTURNOFF.switch&&!0||!1}}},function(){o.loaddata()},function(){o.loaddata()})},o.cancelthreshold=function(){o.showThreshold=!1,o.AUTOTURNOFF=angular.copy(o.originAUTOTURNOFF)},o.threshold=function(){o.showThreshold=!1,t.moduleevent.update({projectid:e.Project.selected._id,modules:{AUTOTURNOFF:{threshold:o.AUTOTURNOFF&&o.AUTOTURNOFF.threshold}}},function(){o.loaddata()},function(){o.loaddata()})},o.changeEvent=function(o){var n={};n[o.name]=o.value,n.mid=o.mid,t.message.update({projectid:e.Project.selected._id,configitems:n})}}]);