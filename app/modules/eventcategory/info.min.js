"use strict";angular.module("app").controller("eventcategoryIndex",["$rootScope","$scope","$api","SweetAlert",function(e,t,o,n){o.message.list({projectid:e.Project.selected._id},function(e){t.Eventcategory=e.result,t.Eventcategory.eventShow=[],angular.forEach(t.Eventcategory,function(e,o){"欠费停止服务"==e.title&&(e.stop=!0),t.Eventcategory.eventShow[o]=[],t.Eventcategory.eventShow[o].title=e.title,angular.forEach(e,function(n,r){var l={name:r,value:n,mid:e.mid};"title"!=l.name&&"mid"!=l.name&&t.Eventcategory.eventShow[o].push(l)})})}).$promise.then(function(){t.loaddata=function(){o.moduleevent.info({projectid:e.Project.selected._id},function(e){e=e.result,t.originAUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&angular.copy(e.AUTOTURNOFF)||{threshold:0},t.AUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&e.AUTOTURNOFF||{threshold:0},t.$watch("AUTOTURNOFF.threshold",function(e){e.threshold!=(t.originAUTOTURNOFF&&t.originAUTOTURNOFF.threshold)&&(t.showThreshold=!0)})},function(e){e=e.result,t.originAUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&angular.copy(e.AUTOTURNOFF)||{threshold:0},t.AUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&e.AUTOTURNOFF||{threshold:0},t.$watch("AUTOTURNOFF.threshold",function(e){console.log(t.AUTOTURNOFF,t.originAUTOTURNOFF.threshold),t.AUTOTURNOFF.threshold!=(t.originAUTOTURNOFF&&t.originAUTOTURNOFF.threshold)&&(t.showThreshold=!0)||(t.showThreshold=!1)})})},t.loaddata()}),t.switch=function(){o.moduleevent.update({projectid:e.Project.selected._id,modules:{AUTOTURNOFF:{switch:t.AUTOTURNOFF&&t.AUTOTURNOFF.switch}}}).$promise.then(t.loaddata)},t.cancelthreshold=function(){t.showThreshold=!1,t.AUTOTURNOFF=angular.copy(t.originAUTOTURNOFF)},t.threshold=function(){t.showThreshold=!1,o.moduleevent.update({projectid:e.Project.selected._id,modules:{AUTOTURNOFF:{threshold:t.AUTOTURNOFF&&t.AUTOTURNOFF.threshold}}}).$promise.then(t.loaddata)},t.changeEvent=function(t){var n={};n[t.name]=t.value,n.mid=t.mid,o.message.update({projectid:e.Project.selected._id,configitems:n})}}]);