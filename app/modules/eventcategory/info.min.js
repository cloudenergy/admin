"use strict";angular.module("app").controller("eventcategoryIndex",["$rootScope","$scope","$api","SweetAlert",function(o,r,n,e){n.message.list({projectid:o.Project.selected._id},function(e){r.Eventcategory=e.result,r.Eventcategory.eventShow=[],angular.forEach(r.Eventcategory,function(n,a){r.Eventcategory.eventShow[a]=[],r.Eventcategory.eventShow[a].title=n.title,angular.forEach(n,function(e,t){var o={name:t,value:e,mid:n.mid};"title"!=o.name&&"mid"!=o.name&&r.Eventcategory.eventShow[a].push(o)}),"欠费停止服务"==n.title&&(n.stop=!0)})}).$promise.then(function(){r.loaddata=function(){n.moduleevent.info({projectid:o.Project.selected._id},function(e){e=e.result,r.originAUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&angular.copy(e.AUTOTURNOFF)||{threshold:0},r.AUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&e.AUTOTURNOFF||{threshold:0},r.$watch("AUTOTURNOFF.threshold",function(e){r.AUTOTURNOFF.threshold!=(r.originAUTOTURNOFF&&r.originAUTOTURNOFF.threshold)&&(r.showThreshold=!0)||(r.showThreshold=!1)})},function(e){e=e.result,r.originAUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&angular.copy(e.AUTOTURNOFF)||{threshold:0},r.AUTOTURNOFF=!angular.equals(e.AUTOTURNOFF,{})&&e.AUTOTURNOFF||{threshold:0},r.$watch("AUTOTURNOFF.threshold",function(e){r.AUTOTURNOFF.threshold!=(r.originAUTOTURNOFF&&r.originAUTOTURNOFF.threshold)&&(r.showThreshold=!0)||(r.showThreshold=!1)})})},r.loaddata()}),r.switch=function(){n.moduleevent.update({projectid:o.Project.selected._id,modules:{AUTOTURNOFF:{switch:!(!r.AUTOTURNOFF||!r.AUTOTURNOFF.switch)}}},function(){r.loaddata()},function(){r.loaddata()})},r.cancelthreshold=function(){r.showThreshold=!1,r.AUTOTURNOFF=angular.copy(r.originAUTOTURNOFF)},r.threshold=function(){r.showThreshold=!1,n.moduleevent.update({projectid:o.Project.selected._id,modules:{AUTOTURNOFF:{threshold:r.AUTOTURNOFF&&r.AUTOTURNOFF.threshold}}},function(){r.loaddata()},function(){r.loaddata()})},r.changeEvent=function(e){var t={};t[e.name]=e.value,t.mid=e.mid,n.message.update({projectid:o.Project.selected._id,configitems:t})}}]);