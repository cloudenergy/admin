"use strict";angular.module("app").controller("SensorSelect",["$scope","$rootScope","$uibModalInstance","$api","ProjectID","EnergycategoryID",function(e,n,r,a,i,o){function s(e){var n=e.split("|");return _.isArray(n)?n[0]||e:e}var t;e.currentPage=1,e.popPageSize=8,e.Ok=function(){var n=s(o),i=!0;_.each(e.viewOfSensors,function(e){e.originEnable!=e.isEnable&&(e.isEnable&&e.energyPath!=o?(i=!1,a.sensorchannel.update({_id:e._id,energy:n,energyPath:o},function(){r.close({})})):a.sensorchannel.update({_id:e._id,energy:"",energyPath:""},function(){r.close({})}))}),i&&r.close({})},e.Cancel=function(){r.dismiss("cancel")},e.SwitchSensor=function(e,n){e.preventDefault(),n.isEnable?n.isEnable=!1:n.isEnable=!0},e.onSearchSensor=function(n){n.preventDefault(),e.UpdateViewOfSensors(e.sensorSearchKey)},e.OnSelectAll=function(n){n.preventDefault();for(var r=(e.currentPage-1)*e.popPageSize,a=e.currentPage*e.popPageSize,i=r;i<a;i++)e.viewOfSensors[i].isEnable=!0},e.UpdateViewOfSensors=function(n){e.viewOfSensors=[],n?_.each(t,function(r){r.title.match(n)?e.viewOfSensors.push(r):r.channel&&r.channel.match(n)&&e.viewOfSensors.push(r)}):e.viewOfSensors=t,_.each(e.viewOfSensors,function(e){e.originEnable=e.energyPath==o,e.isEnable=e.originEnable})},a.sensorchannel.info({project:i},function(n){t=n.result,e.UpdateViewOfSensors()})}]);