"use strict";angular.module("app").controller("SensorSelect",["$scope","$rootScope","$uibModalInstance","$api","ProjectID","EnergycategoryID",function(i,e,a,o,n,s){var r;i.currentPage=1,i.popPageSize=8,i.Ok=function(){var n=function(e){var n=e.split("|");return _.isArray(n)&&n[0]||e}(s),r=!0;_.each(i.viewOfSensors,function(e){e.originEnable!=e.isEnable&&(e.isEnable&&e.energyPath!=s?(r=!1,o.sensorchannel.update({_id:e._id,energy:n,energyPath:s},function(){a.close({})})):o.sensorchannel.update({_id:e._id,energy:"",energyPath:""},function(){a.close({})}))}),r&&a.close({})},i.Cancel=function(){a.dismiss("cancel")},i.SwitchSensor=function(e,n){e.preventDefault(),n.isEnable?n.isEnable=!1:n.isEnable=!0},i.onSearchSensor=function(e){e.preventDefault(),i.UpdateViewOfSensors(i.sensorSearchKey)},i.OnSelectAll=function(e){e.preventDefault();for(var n=(i.currentPage-1)*i.popPageSize,r=i.currentPage*i.popPageSize,a=n;a<r;a++)i.viewOfSensors[a].isEnable=!0},i.UpdateViewOfSensors=function(n){i.viewOfSensors=[],n?_.each(r,function(e){e.title.match(n)?i.viewOfSensors.push(e):e.channel&&e.channel.match(n)&&i.viewOfSensors.push(e)}):i.viewOfSensors=r,_.each(i.viewOfSensors,function(e){e.originEnable=e.energyPath==s,e.isEnable=e.originEnable})},o.sensorchannel.info({project:n},function(e){r=e.result,i.UpdateViewOfSensors()})}]);