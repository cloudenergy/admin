"use strict";angular.module("app").controller("SensorSelect",["$scope","$rootScope","$uibModalInstance","$api","ProjectID","Config","EnergycategoryID",function(e,n,r,i,a,o,s){function t(e){var n=e.split("|");return _.isArray(n)?n[0]||e:e}var c;e.currentPage=1,e.Ok=function(){var n=t(s),a=!0;_.each(e.viewOfSensors,function(e){if(e.originEnable!=e.isEnable)if(e.isEnable&&e.energyPath!=s){a=!1;var o={_id:e._id,energy:n,energyPath:s};i.sensorchannel.update(o,function(){r.close({})})}else i.sensorchannel.update({_id:e._id,energy:"",energyPath:""},function(){r.close({})})}),a&&r.close({})},e.Cancel=function(){r.dismiss("cancel")},e.SwitchSensor=function(e,n){e.preventDefault(),n.isEnable?n.isEnable=!1:n.isEnable=!0},e.onSearchSensor=function(n){n.preventDefault(),e.UpdateViewOfSensors(e.sensorSearchKey)},e.OnSelectAll=function(r){r.preventDefault();for(var i=(e.currentPage-1)*n.popPageSize,a=e.currentPage*n.popPageSize,o=i;o<a;o++)e.viewOfSensors[o].isEnable=!0},e.UpdateViewOfSensors=function(n){e.viewOfSensors=[],n?_.each(c,function(r){r.title.match(n)?e.viewOfSensors.push(r):r.channel&&r.channel.match(n)&&e.viewOfSensors.push(r)}):e.viewOfSensors=c,_.each(e.viewOfSensors,function(e){e.originEnable=e.energyPath==s,e.isEnable=e.originEnable})},i.sensorchannel.info({project:a},function(n){c=n.result,e.UpdateViewOfSensors()})}]);