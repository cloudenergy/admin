"use strict";angular.module("app").controller("accountInfo",["$scope","$api","SweetAlert","$uibModal",function(e,n,t,c){e.askingRemoveID=void 0,e.currentPage=1,e.getAccounts=function(){n.account.info({key:e.searchKey,pageindex:e.currentPage||1,pagesize:15},function(n){e.accounts=n.result},function(e){!/90000005|90000007/.test(e.code)&&t.error(e)})},e.DoRemove=function(c,o,a){c.preventDefault(),n.account.delete({id:o},function(){e.accounts.accounts.splice(a,1)},t.error)},e.AskForRemove=function(n,t){n.preventDefault(),e.askingRemoveID=t},e.CancelRemove=function(n){n.preventDefault(),e.askingRemoveID=void 0},e.$watch("currentPage",function(n){if(!n)return void e.getAccounts();e.getAccounts()}),e.onSearch=function(){e.getAccounts()},e.accountChange=function(e,o){var a={mobile:"mobileChange.html",title:"titleChange.html",email:"emailChange.html"};c.open({size:"sm",templateUrl:a[o],controller:["$scope","$uibModalInstance",function(c,o){c.account=angular.copy(e),c.title=c.account.title,c.ok=function(){n.account.update(c.account,function(){angular.extend(e,c.account),t.success("更新成功")},t.error),c.OnCancel=o.dismiss("cancel")},c.cancel=function(){c.OnCancel=o.dismiss("cancel")}}]})},e.popIsOpen=function(){angular.forEach(e.accounts.accounts,function(e){delete e.titleIsOpen,delete e.mobileIsOpen,delete e.emailIsOpen})},e.popover={url:{title:"titleChange.html",mobile:"mobileChange.html",email:"emailChange.html"},title:{title:"帐号名称修改",mobile:"手机号修改",email:"邮箱修改"},ok:function(c,o,a){var u=o+"IsOpen";c[u]=!1,e.account=angular.copy(c),e.account[o]=a[o],n.account.update(e.account,function(){c[o]=a[o],t.success("更新成功")},t.error)},cancel:function(e,n){e[n+"IsOpen"]=!1}}}]);