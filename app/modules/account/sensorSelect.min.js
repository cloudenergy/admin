"use strict";angular.module("app").controller("SensorSelect",["$scope","$uibModalInstance","$api","ProjectID","SensorIDs",function(e,n,s,i,o){var c;e.Ok=function(){var s=[],i=[];e.viewOfSensors[0].isEnable?s=e.viewOfSensors[0]._id:_.each(e.viewOfSensors,function(e){var n="";e.project&&(n=_.isObject(e.project)?e.project&&e.project._id+"."||"":e.project+"."||""),e.isEnable?s.push(n+e._id):i.push(n+e._id)}),n.close({select:s,unselect:i})},e.Cancel=function(){n.dismiss("cancel")},e.SwitchSensor=function(n,s){n.preventDefault(),"*"==s._id?(_.each(e.viewOfSensors,function(e){e.isEnable=!1}),s.isEnable=!s.isEnable):(e.viewOfSensors[0].isEnable=!1,s.isEnable=!s.isEnable)},e.onSearchSensor=function(n){n.preventDefault(),e.UpdateViewOfSensors(e.sensorSearchKey)},e.UpdateViewOfSensors=function(n){e.viewOfSensors=[{_id:"*",title:"所有传感器"}],n?_.each(c,function(s){s.title.match(n)&&e.viewOfSensors.push(s)}):e.viewOfSensors=_.union(e.viewOfSensors,c);var s=!1;_.each(e.viewOfSensors,function(e){_.contains(o,e._id)?(s=!0,e.isEnable=!0):e.isEnable=!1}),s||(e.viewOfSensors[0].isEnable=!0)};var r=[];_.each(o,function(e){r.push(e.replace(/.+\./g,""))}),o=r,s.sensorchannel.info({project:i},function(n){c=n.result,e.UpdateViewOfSensors()})}]);