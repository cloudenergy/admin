"use strict";angular.module("app").controller("SensorSelect",["$scope","$rootScope","$uibModalInstance","$api","ProjectID","SensorIDs",function(e,n,s,i,o,c){var t;e.popPageSize=8,e.Ok=function(){var n=[],i=[];e.viewOfSensors[0].isEnable?n=e.viewOfSensors[0]._id:_.each(e.viewOfSensors,function(e){var s="";e.project&&(s=_.isObject(e.project)?e.project&&e.project._id+"."||"":e.project+"."||""),e.isEnable?n.push(s+e._id):i.push(s+e._id)}),s.close({select:n,unselect:i})},e.Cancel=function(){s.dismiss("cancel")},e.SwitchSensor=function(n,s){n.preventDefault(),"*"==s._id?(_.each(e.viewOfSensors,function(e){e.isEnable=!1}),s.isEnable=!s.isEnable):(e.viewOfSensors[0].isEnable=!1,s.isEnable=!s.isEnable)},e.onSearchSensor=function(n){n.preventDefault(),e.UpdateViewOfSensors(e.sensorSearchKey)},e.UpdateViewOfSensors=function(n){e.viewOfSensors=[{_id:"*",title:"所有智能仪表"}],n?_.each(t,function(s){s.title.match(n)&&e.viewOfSensors.push(s)}):e.viewOfSensors=_.union(e.viewOfSensors,t);var s=!1;_.each(e.viewOfSensors,function(e){_.contains(c,e._id)?(s=!0,e.isEnable=!0):e.isEnable=!1}),s||(e.viewOfSensors[0].isEnable=!0)},i.device.type({project:n.Project.selected._id},function(n){e.devicetype=[],angular.forEach(n.result,function(n){e.devicetype[n.id]=n,e.devicetype.push(n)})});var r=[];_.each(c,function(e){r.push(e.replace(/.+\./g,""))}),c=r,i.sensorchannel.info({project:o},function(n){t=n.result,e.UpdateViewOfSensors()})}]);