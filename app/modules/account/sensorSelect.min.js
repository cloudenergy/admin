"use strict";angular.module("app").controller("SensorSelect",["$scope","$rootScope","$uibModalInstance","$api","ProjectID","SensorIDs",function(o,e,n,s,i,c){var r;o.popPageSize=8,o.Ok=function(){var s=[],i=[];o.viewOfSensors[0].isEnable?s=o.viewOfSensors[0]._id:_.each(o.viewOfSensors,function(e){var n="";e.project&&(n=_.isObject(e.project)?e.project&&e.project._id+"."||"":e.project+"."||""),e.isEnable?s.push(n+e._id):i.push(n+e._id)}),n.close({select:s,unselect:i})},o.Cancel=function(){n.dismiss("cancel")},o.SwitchSensor=function(e,n){e.preventDefault(),"*"==n._id?_.each(o.viewOfSensors,function(e){e.isEnable=!1}):o.viewOfSensors[0].isEnable=!1,n.isEnable=!n.isEnable},o.onSearchSensor=function(e){e.preventDefault(),o.UpdateViewOfSensors(o.sensorSearchKey)},o.UpdateViewOfSensors=function(n){o.viewOfSensors=[{_id:"*",title:"所有智能仪表"}],n?_.each(r,function(e){e.title.match(n)&&o.viewOfSensors.push(e)}):o.viewOfSensors=_.union(o.viewOfSensors,r);var s=!1;_.each(o.viewOfSensors,function(e){_.contains(c,e._id)?(s=!0,e.isEnable=!0):e.isEnable=!1}),s||(o.viewOfSensors[0].isEnable=!0)};var t=[];_.each(c,function(e){t.push(e.replace(/.+\./g,""))}),c=t,s.sensorchannel.info({project:i},function(e){r=e.result,o.UpdateViewOfSensors()})}]);