"use strict";angular.module("app").controller("accountCreate",["$scope","$q","$state","$cookies","$api","UI",function(r,c,e,t,n,a){r.warning={},r.submit=function(c){return r.account.user.length<6?void a.AlertError("帐号不能低于6位"):r.newpasswd!=r.repeatnewpasswd?void a.AlertError("二次密码输入不一致，请重新输入"):(void 0==r.newpasswd&&null==r.newpasswd||(r.account.passwd=r.newpasswd),r.characters.selected?(r.account.character=r.characters.selected._id,r.account.message=Object.keys(r.warning).filter(function(c){return r.warning[c]?c:""}).join(","),void n.billingaccount.add({account:r.account.user,title:r.account.user},function(c){r.account.billingAccount=c.result._id,n.account.add(r.account,function(){a.AlertSuccess("创建成功"),e.go("admin.account.info")},function(r){a.AlertError("创建错误: "+r.message)})},a.AlertError)):void a.AlertError("请选择权限级别"))},n.account.info({id:t.user},function(c){r.adminUser=c.result,n.character.info({power:r.adminUser.character&&r.adminUser.character.level},function(c){r.characters=c.result,r.characters.selected=r.characters[r.characters.length-1]},a.AlertError)},a.AlertError)}]);