"use strict";angular.module("app").controller("accountCreate",["$scope","$q","$state","$api","User","SweetAlert",function(c,e,r,a,t,n){c.warning={},c.submit=function(e){c.account.user.length<6?n.error("帐号不能低于6位"):c.newpasswd==c.repeatnewpasswd?(null==c.newpasswd&&null==c.newpasswd||(c.account.passwd=c.newpasswd),c.characters.selected?"TENEMENTENGINEER"!=c.characters.selected._id&&"TECHSUPPORT"!=c.characters.selected._id||c.account.email?(c.account.character=c.characters.selected._id,c.account.message=Object.keys(c.warning).filter(function(e){return c.warning[e]?e:""}).join(","),a.billingaccount.add({account:c.account.user,title:c.account.user},function(e){c.account.billingAccount=e.result._id,a.account.add(c.account,function(){n.success("新建成功"),r.go("admin.account.info")},function(e){n.error("新建错误: "+e.message)})},n.error)):n.error("物业工程和技术支持必须填写邮箱"):n.error("请选择权限级别")):n.error("二次密码输入不一致，请重新输入")},a.account.info({id:t.data._id},function(e){c.adminUser=e.result,a.character.info({power:c.adminUser.character&&c.adminUser.character.level},function(e){c.characters=e.result,c.characters.selected=c.characters[c.characters.length-1]},n.error)},n.error)}]);