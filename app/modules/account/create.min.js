"use strict";angular.module("app").controller("accountCreate",["$scope","$q","$state","$api","User","UI",function(r,e,c,t,a,n){r.warning={},r.submit=function(e){return r.account.user.length<6?void n.AlertError("帐号不能低于6位"):r.newpasswd!=r.repeatnewpasswd?void n.AlertError("二次密码输入不一致，请重新输入"):(void 0==r.newpasswd&&null==r.newpasswd||(r.account.passwd=r.newpasswd),r.characters.selected?"TENEMENTENGINEER"!=r.characters.selected._id&&"TECHSUPPORT"!=r.characters.selected._id||r.account.email?(r.account.character=r.characters.selected._id,r.account.message=Object.keys(r.warning).filter(function(e){return r.warning[e]?e:""}).join(","),void t.billingaccount.add({account:r.account.user,title:r.account.user},function(e){r.account.billingAccount=e.result._id,t.account.add(r.account,function(){n.AlertSuccess("新建成功"),c.go("admin.account.info")},function(r){n.AlertError("新建错误: "+r.message)})},n.AlertError)):void n.AlertError("物业工程和技术支持必须填写邮箱"):void n.AlertError("请选择权限级别"))},t.account.info({id:a.data._id},function(e){r.adminUser=e.result,t.character.info({power:r.adminUser.character&&r.adminUser.character.level},function(e){r.characters=e.result,r.characters.selected=r.characters[r.characters.length-1]},n.AlertError)},n.AlertError)}]);