"use strict";angular.module("app").controller("accountCreate",["$scope","$q","$state","$api","User","SweetAlert",function(e,c,r,a,t,n){e.warning={},e.submit=function(c){e.account.user.length<6?n.error("帐号不能低于6位"):e.newpasswd==e.repeatnewpasswd?(void 0==e.newpasswd&&null==e.newpasswd||(e.account.passwd=e.newpasswd),e.characters.selected?"TENEMENTENGINEER"!=e.characters.selected._id&&"TECHSUPPORT"!=e.characters.selected._id||e.account.email?(e.account.character=e.characters.selected._id,e.account.message=Object.keys(e.warning).filter(function(c){return e.warning[c]?c:""}).join(","),a.billingaccount.add({account:e.account.user,title:e.account.user},function(c){e.account.billingAccount=c.result._id,a.account.add(e.account,function(){n.success("新建成功"),r.go("admin.account.info")},function(e){n.error("新建错误: "+e.message)})},n.error)):n.error("物业工程和技术支持必须填写邮箱"):n.error("请选择权限级别")):n.error("二次密码输入不一致，请重新输入")},a.account.info({id:t.data._id},function(c){e.adminUser=c.result,a.character.info({power:e.adminUser.character&&e.adminUser.character.level},function(c){e.characters=c.result,e.characters.selected=e.characters[e.characters.length-1]},n.error)},n.error)}]);