"use strict";angular.module("app").controller("accountCreate",["$scope","$q","$state","$cookies","$api","Auth","UI",function(e,r,c,t,a,n,o){n.Check(function(){e.warning={},e.submit=function(r){return e.account.user.length<6?void o.AlertError("用户名不能低于6位"):e.newpasswd!=e.repeatnewpasswd?void o.AlertError("二次密码输入不一致，请重新输入"):(void 0==e.newpasswd&&null==e.newpasswd||(e.account.passwd=e.newpasswd),e.characters.selected?(e.account.character=e.characters.selected._id,e.account.message=Object.keys(e.warning).filter(function(r){return e.warning[r]?r:""}).join(","),void a.billingaccount.add({account:e.account.user,title:e.account.user},function(r){r.code?o.AlertError(r.message):(e.account.billingAccount=r.result._id,a.account.add(e.account,function(e){e.code?o.AlertError("账户创建错误: "+e.message):(o.AlertSuccess("创建账户成功"),c.go("admin.account.info"))}))})):void o.AlertError("请选择创建账户的权限级别"))},a.account.info({id:t.user},function(r){if(r.code)o.AlertError(r.message);else{e.adminUser=r.result;var c=e.adminUser.character&&e.adminUser.character.level;a.character.info({power:c},function(r){r.code?o.AlertError(r.message):(e.characters=r.result,e.characters.selected=e.characters[e.characters.length-1])})}})})}]);