"use strict";angular.module("app").controller("accountCreate",["$scope","$q","$state","$cookies","$api","Auth","UI",function(e,r,c,t,n,a,o){a.Check(function(){e.warning={},e.submit=function(r){return e.account.user.length<6?void o.AlertError("用户名不能低于6位"):e.newpasswd!=e.repeatnewpasswd?void o.AlertError("二次密码输入不一致，请重新输入"):(void 0==e.newpasswd&&null==e.newpasswd||(e.account.passwd=e.newpasswd),e.characters.selected?(e.account.character=e.characters.selected._id,e.account.message=Object.keys(e.warning).filter(function(r){return e.warning[r]?r:""}).join(","),void n.billingaccount.add({account:e.account.user,title:e.account.user},function(r){e.account.billingAccount=r.result._id,n.account.add(e.account,function(){o.AlertSuccess("创建账户成功"),c.go("admin.account.info")},function(e){o.AlertError("账户创建错误: "+e.message)})},function(e){o.AlertError(e.message)})):void o.AlertError("请选择创建账户的权限级别"))},n.account.info({id:t.user},function(r){e.adminUser=r.result,n.character.info({power:e.adminUser.character&&e.adminUser.character.level},function(r){e.characters=r.result,e.characters.selected=e.characters[e.characters.length-1]},function(e){o.AlertError(e.message)})},function(e){o.AlertError(e.message)})})}]);