"use strict";angular.module("app").controller("login",["$api","$cookies","$state","UI","md5","$scope",function(e,r,o,t,n,a){var c,m=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname,s=function(e){e=e.result,angular.forEach(["token","uid","user"],function(o){e[o]&&r.put(o,e[o],{path:"/",domain:m,expires:c&&moment().add(1,"months")._d||void 0})}),e.token?o.go("admin.dashboard"):(o.go("login"),t.AlertError(e.message,"登录失败"))};a.user=localStorage.user,a.$watch("rememberaccount",function(){a.rememberaccount?"":a.remember=a.rememberaccount}),a.$watch("remember",function(){a.remember?a.rememberaccount=a.remember:""}),a.login=function(){var r=this&&this.user,o=this&&this.password,m=[];c=a.remember,a.rememberaccount?localStorage.user=r:"",!r&&m.push("帐号"),!o&&m.push("密码"),m=m.join("与"),m&&t.AlertError("请输入您的"+m),!m&&e.auth.login({user:r,passwd:n.createHash(o).toUpperCase()},s,function(e){t.AlertError("服务器错误","错误: "+e.code)})}}]);