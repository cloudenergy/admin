"use strict";angular.module("app").controller("CollectorIndex",["$rootScope","$scope","$api","$uibModal","SweetAlert",function(e,t,c,n,l){t.currentPage=1,t.askingRemoveID=void 0,t.DoRemove=function(e,n,o){e.preventDefault(),c.collector.delete({id:n},function(){t.items.detail.splice(o,1)},l.error)},t.AskForRemove=function(e,c){e.preventDefault(),t.askingRemoveID=c},t.CancelRemove=function(e){e.preventDefault(),t.askingRemoveID=void 0},t.switchStatus=function(t,l){l.preventDefault(),n.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(n,l){n.item=angular.copy(t),n.ok=function(){c.collector.status({id:t.id,projectid:e.Project.selected._id,status:"ONLINE"==t.status&&"DEBUG"||"ONLINE"},function(){t.status="ONLINE"==n.item.status&&"DEBUG"||"ONLINE",l.dismiss("cancel")},function(){l.dismiss("cancel")})},n.cancel=function(){l.dismiss("cancel")}}]})},t.multiCheck=function(e){"all"===e?(t.multiCheck.all&&(t.showButton=!0),!t.multiCheck.all&&(t.showButton=!1),angular.forEach(t.items.detail,function(e){e.isSelected=t.multiCheck.all})):(t.multiCheck.all=!0,t.showButton=!1,angular.forEach(t.items.detail,function(e){e.isSelected||delete t.multiCheck.all,e.isSelected&&(t.showButton=!0)}))},t.multiIds=function(){var e=[];return angular.forEach(t.items.detail,function(t){t.isSelected&&e.push(t.id)}),e},t.switchAll=function(l,o){o.preventDefault();var i=t;n.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(t,n){t.ok=function(){c.collector.status({id:i.multiIds(),projectid:e.Project.selected._id,status:l},function(){c.collector.info({project:e.Project.selected._id},function(e){delete i.multiCheck.all,i.items=e.result,n.dismiss("cancel")})},function(){n.dismiss("cancel")})},t.cancel=function(){n.dismiss("cancel")}}]})},t.popIsOpen=function(){angular.forEach(t.items.detail,function(e){delete e.titleIsOpen})},t.popover={url:{title:"titleChange.html"},title:{title:"管理器名称修改"},ok:function(e,n,o){e[n+"IsOpen"]=!1,t.item=angular.copy(e),t.item[n]=o[n],c.collector.update(t.item,function(){e[n]=o[n],l.success("更新成功")},l.error)},cancel:function(e,t){e[t+"IsOpen"]=!1}},t.$watch("currentPage",function(){c.collector.info({project:e.Project.selected._id,pageindex:t.currentPage,pagesize:10},function(e){t.items=e.result},function(){delete t.items})})}]);