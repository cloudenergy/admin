"use strict";angular.module("app").controller("CollectorIndex",["$rootScope","$scope","$api","$uibModal","SweetAlert",function(e,t,c,n,o){t.currentPage=1,t.askingRemoveID=void 0,t.DoRemove=function(e,n,l){e.preventDefault(),c.collector.delete({id:n},function(){t.items.detail.splice(l,1)},o.error)},t.AskForRemove=function(e,c){e.preventDefault(),t.askingRemoveID=c},t.CancelRemove=function(e){e.preventDefault(),t.askingRemoveID=void 0},t.switchStatus=function(t,o){o.preventDefault(),n.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(n,o){n.item=angular.copy(t),n.ok=function(){c.collector.status({id:t.id,projectid:e.Project.selected._id,status:"ONLINE"==t.status&&"DEBUG"||"ONLINE"},function(){t.status="ONLINE"==n.item.status&&"DEBUG"||"ONLINE",o.dismiss("cancel")},function(){o.dismiss("cancel")})},n.cancel=function(){o.dismiss("cancel")}}]})},t.multiCheck=function(e){"all"===e?(t.multiCheck.all&&(t.showButton=!0),!t.multiCheck.all&&(t.showButton=!1),angular.forEach(t.items,function(e){e.isSelected=t.multiCheck.all})):(t.multiCheck.all=!0,t.showButton=!1,angular.forEach(t.items,function(e){e.isSelected||delete t.multiCheck.all,e.isSelected&&(t.showButton=!0)}))},t.multiIds=function(){var e=[];return angular.forEach(t.items,function(t){t.isSelected&&e.push(t.id)}),e},t.switchAll=function(o,l){l.preventDefault();var i=t;n.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(t,n){t.ok=function(){c.collector.status({id:i.multiIds(),projectid:e.Project.selected._id,status:o},function(){c.collector.info({project:e.Project.selected._id},function(e){delete i.multiCheck.all,i.items=e.result,n.dismiss("cancel")})},function(){n.dismiss("cancel")})},t.cancel=function(){n.dismiss("cancel")}}]})},t.popIsOpen=function(){angular.forEach(t.items,function(e){delete e.titleIsOpen})},t.popover={url:{title:"titleChange.html"},title:{title:"管理器名称修改"},ok:function(e,n,l){e[n+"IsOpen"]=!1,t.item=angular.copy(e),t.item[n]=l[n],c.collector.update(t.item,function(){e[n]=l[n],o.success("更新成功")},o.error)},cancel:function(e,t){e[t+"IsOpen"]=!1}},t.$watch("currentPage",function(){c.collector.info({project:e.Project.selected._id,pageindex:t.currentPage,pagesize:10},function(e){t.items=e.result},function(){delete t.items})})}]);