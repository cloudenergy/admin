"use strict";angular.module("app").controller("CollectorIndex",["$rootScope","$scope","$api","$uibModal","SweetAlert",function(e,t,c,o,n){t.currentPage=1,t.pageSize=15,t.askingRemoveID=void 0,t.DoRemove=function(e,o,l){e.preventDefault(),c.collector.delete({id:o},function(){t.items.splice(t.pageSize*(t.currentPage-1)+l,1)},n.error)},t.AskForRemove=function(e,c){e.preventDefault(),t.askingRemoveID=c},t.CancelRemove=function(e){e.preventDefault(),t.askingRemoveID=void 0},t.switchStatus=function(t,n){n.preventDefault(),o.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(o,n){o.item=angular.copy(t),o.ok=function(){c.collector.status({id:t._id,projectid:e.Project.selected._id,status:"ONLINE"==t.status&&"DEBUG"||"ONLINE"},function(){t.status="ONLINE"==o.item.status&&"DEBUG"||"ONLINE",n.dismiss("cancel")},function(){n.dismiss("cancel")})},o.cancel=function(){n.dismiss("cancel")}}]})},t.multiCheck=function(e){"all"===e?(t.multiCheck.all&&(t.showButton=!0),!t.multiCheck.all&&(t.showButton=!1),angular.forEach(t.items,function(e){e.isSelected=t.multiCheck.all})):(t.multiCheck.all=!0,t.showButton=!1,angular.forEach(t.items,function(e){e.isSelected||delete t.multiCheck.all,e.isSelected&&(t.showButton=!0)}))},t.multiIds=function(){var e=[];return angular.forEach(t.items,function(t){t.isSelected&&e.push(t._id)}),e},t.switchAll=function(n,l){l.preventDefault();var i=t;o.open({templateUrl:"modal-collectorStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(t,o){t.ok=function(){c.collector.status({id:i.multiIds(),projectid:e.Project.selected._id,status:n},function(){c.collector.info({project:e.Project.selected._id},function(e){delete i.multiCheck.all,i.items=e.result,o.dismiss("cancel")})},function(){o.dismiss("cancel")})},t.cancel=function(){o.dismiss("cancel")}}]})},t.popIsOpen=function(){angular.forEach(t.items,function(e){delete e.titleIsOpen})},t.popover={url:{title:"titleChange.html"},title:{title:"管理器名称修改"},ok:function(e,o,l){var i=o+"IsOpen";e[i]=!1,t.item=angular.copy(e),t.item[o]=l[o],c.collector.update(t.item,function(){e[o]=l[o],n.success("更新成功")},n.error)},cancel:function(e,t){e[t+"IsOpen"]=!1}},c.collector.info({project:e.Project.selected._id},function(e){t.items=e.result},function(){delete t.items})}]);