"use strict";angular.module("app").component("billingserviceSensorSelect",{templateUrl:"app/modules/billingservice/sensor-select.html?rev=39aaccae64",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api","$uibModal",function(e,r){var o=this;o.currentPage=1,o.popPageSize=10,o.devicetype=[{id:void 0,name:"全部类型"}],o.$onInit=function(){e.device.type({project:o.resolve.projectid},function(e){angular.forEach(e.result,function(e){o.devicetype[e.id]=e,o.devicetype.push(e)})});var n=o.resolve.addItemsIDs||[];e.billingservice.equipments({project:o.resolve.projectid,strategyid:o.resolve.strategyid,SHOWALL:!0},function(e){angular.forEach(o.listData=e.result,function(e){e.isEnable=!!e.selected,~n.indexOf(e.id)&&(e.isEnable=!0)})})},o.filterItem=function(e){var n=!0;return(n=o.devicetype.selected?!!~e.devicetype.indexOf(o.devicetype.selected):n)&&(n=o.sensorSearchKey?!(!~e.title.indexOf(o.sensorSearchKey)&&!~e.channelname.indexOf(o.sensorSearchKey)):n),n},o.SelectAll=function(){angular.forEach(o.listData,function(e){e.isEnable=!0})},o.AntiElection=function(){angular.forEach(o.listData,function(e){e.isEnable=!e.isEnable})},o.Ok=function(){var n=[],t=[],i=[],s=[];angular.forEach(o.filterData,function(e){e.selected!==e.isEnable&&(e.isEnable?(n.push(e),t.push(e.id)):(i.push(e),s.push(e.id)))}),o.resolve.strategyid?n.length||i.length?r.open({component:"billingserviceSensorConfirm",backdrop:"static",resolve:{strategyid:function(){return o.resolve.strategyid},projectid:function(){return o.resolve.projectid},addItems:function(){return n},addItemsIDs:function(){return t},removeItems:function(){return i},removeItemsIDs:function(){return s}}}).result.then(function(){o.close({$value:{addItemsIDs:t,removeItemsIDs:s}})}):o.dismiss():o.close({$value:{addItemsIDs:t}})},o.Cancel=function(){o.dismiss()}}]}),angular.module("app").component("billingserviceSensorConfirm",{templateUrl:"app/modules/billingservice/sensor-confirm.html?rev=69f74f4286",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api","SweetAlert",function(e,n){var t,i,s=this;s.$onInit=function(){t=s.resolve.addItemsIDs,i=s.resolve.removeItemsIDs,s.addItems=s.resolve.addItems,s.removeItems=s.resolve.removeItems},s.Ok=function(){e.billingservice.update({id:s.resolve.strategyid,projectid:s.resolve.projectid,addChannels:t.length?t:void 0,removeChannels:i.length?i:void 0},function(){s.close()},n.error)},s.Cancel=function(){s.dismiss()}}]});