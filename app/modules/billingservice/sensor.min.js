"use strict";angular.module("app").component("billingserviceSensorSelect",{templateUrl:"app/modules/billingservice/sensor-select.html?rev=890bb67052",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api","$uibModal",function(e,n){var t=this;t.currentPage=1,t.popPageSize=10,t.devicetype=[{id:void 0,name:"全部类型"}],t.$onInit=function(){e.device.type({project:t.resolve.projectid},function(e){angular.forEach(e.result,function(e){t.devicetype[e.id]=e,t.devicetype.push(e)})});var n=t.resolve.addItemsIDs||[];e.billingservice.equipments({project:t.resolve.projectid,strategyid:t.resolve.strategyid,SHOWALL:!0},function(e){angular.forEach(t.listData=e.result,function(e){e.isEnable=!!e.selected,~n.indexOf(e.id)&&(e.isEnable=!0)})})},t.filterItem=function(e){var n=!0;return(n=t.devicetype.selected?!!~e.devicetype.indexOf(t.devicetype.selected):n)&&(n=t.sensorSearchKey?!(!~e.title.indexOf(t.sensorSearchKey)&&!~e.channelname.indexOf(t.sensorSearchKey)):n),n},t.SelectAll=function(){angular.forEach(t.listData,function(e){e.isEnable=!0})},t.AntiElection=function(){angular.forEach(t.listData,function(e){e.isEnable=!e.isEnable})},t.Ok=function(){var e=[],i=[],s=[],r=[];angular.forEach(t.filterData,function(n){n.selected!==n.isEnable&&(n.isEnable?(e.push(n),i.push(n.id)):(s.push(n),r.push(n.id)))}),t.resolve.strategyid?e.length||s.length?n.open({component:"billingserviceSensorConfirm",backdrop:"static",resolve:{strategyid:function(){return t.resolve.strategyid},projectid:function(){return t.resolve.projectid},addItems:function(){return e},addItemsIDs:function(){return i},removeItems:function(){return s},removeItemsIDs:function(){return r}}}).result.then(function(){t.close({$value:{addItemsIDs:i,removeItemsIDs:r}})}):t.dismiss():t.close({$value:{addItemsIDs:i}})},t.Cancel=function(){t.dismiss()}}]}),angular.module("app").component("billingserviceSensorConfirm",{templateUrl:"app/modules/billingservice/sensor-confirm.html?rev=d91e45373d",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api","SweetAlert",function(e,n){var t,i,s=this;s.$onInit=function(){t=s.resolve.addItemsIDs,i=s.resolve.removeItemsIDs,s.addItems=s.resolve.addItems,s.removeItems=s.resolve.removeItems},s.Ok=function(){e.billingservice.update({id:s.resolve.strategyid,projectid:s.resolve.projectid,addChannels:t.length?t:void 0,removeChannels:i.length?i:void 0},function(){s.close()},n.error)},s.Cancel=function(){s.dismiss()}}]});