"use strict";angular.module("app").controller("projectEdit",["$rootScope","$scope","$state","$stateParams","$api","UI",function(t,e,o,r,d,c){function n(o){d.project.info({id:o},function(o){e.project=o.result;var d=moment(e.project.onduty,"H:mm");e.ondutyHour.selected=d.format("H"),e.ondutyMinute.selected=d.format("mm");var c=moment(e.project.offduty,"H:mm");e.offdutyHour.selected=c.format("H"),e.offdutyMinute.selected=c.format("mm"),r.id&&(angular.forEach(t.Project,function(e){e._id==r.id&&(t.Project.selected=r.project)}),delete r.id)},c.AlertError)}e.ondutyHour=["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],e.ondutyMinute=["00","10","20","30","40","50"],e.offdutyHour=["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],e.offdutyMinute=["00","10","20","30","40","50"],e.Save=function(e,r){var n={};n.id=t.Project.selected._id,"time"==r?(n.onduty=String(e.onh)+":"+String(e.onm),n.offduty=String(e.offh)+":"+String(e.offm)):n[r]=e,console.log(n),d.project.update(n,function(){"title"==r&&(t.Project.selected.title=e),c.AlertSuccess("修改成功"),o.go("admin.project.edit",{id:t.Project.selected._id},{reload:!0})},c.AlertError)},e.$watch("$root.Project.selected",function(t){!r.id&&n(t._id)}),n(r.id)}]);