"use strict";angular.module("app").component("projectCreate",{templateUrl:"app/modules/project/create.html?rev=5878bb98dc",controller:["$state","$api","ATTRIB","SOURCE","Upload","base64","SweetAlert",function(e,n,t,o,u,i,a){var r=this;r.ondutyHour=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],r.ondutyHour.selected="08",r.ondutyMinute=["00","10","20","30","40","50"],r.ondutyMinute.selected="00",r.offdutyHour=angular.copy(r.ondutyHour),r.offdutyHour.selected="17",r.offdutyMinute=angular.copy(r.ondutyMinute),r.offdutyMinute.selected="00",r.ATTRIB=t,r.SOURCE=o,r.messagePush={},r.uploadImg={upload:function(){angular.isUndefined(r.file[0].key)&&angular.isUndefined(r.file[0].$upload)&&(r.file[0].$upload=1,u.base64DataUrl(r.file[0]).then(function(t){r.file[0].__proto__.$base64=1,n.interaction.uploadtoken({file:(new Date).getTime()+"_"+r.file[0].name},function(e){n.qiniu.upload({base64:i.encode(e.result.file),token:e.result.token},{file:t.split("data:image/jpeg;base64,")[1]},function(e){r.file[0].key=e.key,angular.forEach(r.file[0],function(e,t){/^\$/.test(t)&&delete r.file[0][t]})})})}))},delete:function(){a.swal({title:"确定删除该图片吗？",type:"warning",showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"确认"}).then(function(){n.interaction.remove({file:r.file[0].key},function(){r.file.splice(0,1)})})}},r.submit=function(){r.project.sector?r.project.source?r.project.user.length<6?a.warning("帐号不能低于6位"):!r.project.passwd||r.project.passwd.length<6?a.warning("密码不能低于6位"):(r.file&&(r.project.avatar=r.file[0].key),r.project.character="TENEMENTADMIN",r.project.message=Object.keys(r.messagePush).filter(function(e){return r.messagePush[e]?e:""}).join(","),r.project.onduty=r.ondutyHour.selected+":"+r.ondutyMinute.selected,r.project.offduty=r.offdutyHour.selected+":"+r.offdutyMinute.selected,n.project.add(r.project,function(){a.success("创建成功"),e.go("admin.project.info")},function(e){a.error(e)})):a.warning("请选择项目来源"):a.warning("请选择项目属性")}}]});