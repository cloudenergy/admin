"use strict";angular.module("app").controller("projectInfo",["$rootScope","$scope","$api","UI","$state","$uibModal",function(e,t,o,c,r,n){t.askingRemoveID=void 0,t.currentPage=1,t.pageSize=15,t.Project=e.Project,o.project.info(function(r){angular.forEach(angular.copy(e.Project),function(e,o){delete t.Project[e._id],t.Project.splice(t.Project.length-o-1,1)}),angular.forEach(angular.isArray(r.result)?r.result:[r.result],function(e){t.Project.push(e),t.Project[e._id]=e}),t.Project.selected=t.Project[t.Project.selected._id]||t.Project[0],t.DoRemove=function(r,n){o.project.delete({id:r},function(){e.Project.splice(t.pageSize*(t.currentPage-1)+n,1),t.Project.splice(t.pageSize*(t.currentPage-1)+n,1),delete e.Project[r],delete t.Project[r]},c.AlertError)},t.AskForRemove=function(e){t.askingRemoveID=e},t.statusSwitch=function(t,c){c.preventDefault(),n.open({templateUrl:"modal-projectStatus.html",size:"md",controller:["$scope","$uibModalInstance",function(c,r){c.ok=function(){o.project.status({projectid:t,status:"ONLINE"},function(){o.project.info(function(t){angular.forEach(angular.copy(e.Project),function(t,o){delete e.Project[t._id],e.Project.splice(e.Project.length-o-1,1)}),angular.forEach(angular.isArray(t.result)?t.result:[t.result],function(t){e.Project.push(t),e.Project[t._id]=t})})}),r.dismiss("cancel")},c.cancel=function(){r.dismiss("cancel")}}]})},t.CancelRemove=function(){delete t.askingRemoveID},t.$watch("currentPage",function(){delete t.askingRemoveID})}),t.selecteProject=function(t){e.Project.selected=t,r.go("admin.project.edit",{id:t._id},{reload:!0})},t.onSearch=function(){o.project.info({titlereg:t.searchKey},function(e){angular.isArray(e.result)&&(t.Project=e.result)||(t.Project=[e.result])},function(e){t.Project=[]})}}]);