"use strict";angular.module("app").component("projectInfo",{templateUrl:"app/modules/project/info.html?rev=a4b3f6cc73",controller:["$rootScope","$api","SweetAlert","$state","$uibModal",function(e,o,t,r,n){var c=this;c.currentPage=1,c.pageSize=15,c.$onInit=function(){o.project.info(function(o){e.Project.length=0,angular.forEach(e.Project,function(o){delete e.Project[o._id]}),angular.forEach(angular.isArray(o.result)?o.result:[o.result],function(o){e.Project.push(o),e.Project[o._id]=o}),e.Project[e.Project.selected._id]||(e.Project.selected=e.Project[0])})},c.DoRemove=function(r,n){c.popover.close(),o.project.delete({id:r},function(){e.Project.splice(c.pageSize*(c.currentPage-1)+n,1),delete e.Project[r]},t.error)},c.statusSwitch=function(e){c.popover.close(),n.open({component:"projectInfoStatusSwitch",resolve:{project:function(){return e}}}).result.then(function(o){angular.extend(e,o)})},c.changeTime=function(e){c.popover.close(),n.open({component:"projectInfoChangeTime",resolve:{project:function(){return e}}}).result.then(function(o){angular.extend(e,o)})},c.popover={field:void 0,target:void 0,openChange:function(e,o){c.originalItem=e,c.popover.target=angular.copy(e),c.popover.field=o},ok:function(){var e={id:c.popover.target._id};e[c.popover.field]=c.popover.target[c.popover.field],o.project.update(e,function(){t.success("更新成功"),c.originalItem[c.popover.field]=c.popover.target[c.popover.field],c.popover.close()},t.error)},close:function(){delete c.popover.field,delete c.popover.target}}}]}),angular.module("app").component("projectInfoStatusSwitch",{templateUrl:"project-info-switch-status.html",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api",function(e){var o=this;o.ok=function(){e.project.status({projectid:o.resolve.project._id,status:"ONLINE"},function(){o.close({$value:{status:"ONLINE"}})})},o.cancel=function(){o.dismiss()}}]}),angular.module("app").component("projectInfoChangeTime",{templateUrl:"project-info-change-time.html",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api","SweetAlert",function(e,o){var t=this;t.ondutyHour=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],t.ondutyMinute=["00","10","20","30","40","50"],t.offdutyHour=angular.copy(t.ondutyHour),t.offdutyMinute=angular.copy(t.ondutyMinute),t.$onInit=function(){t.title=t.resolve.project.title;var e=moment(t.resolve.project.onduty,"HH:mm"),o=moment(t.resolve.project.offduty,"HH:mm");t.ondutyHour.selected=e.format("HH"),t.ondutyMinute.selected=e.format("mm"),t.offdutyHour.selected=o.format("HH"),t.offdutyMinute.selected=o.format("mm")},t.ok=function(){t.resolve.project.onduty=String(t.ondutyHour.selected)+":"+String(t.ondutyMinute.selected),t.resolve.project.offduty=String(t.offdutyHour.selected)+":"+String(t.offdutyMinute.selected);var r={id:t.resolve.project._id,onduty:t.resolve.project.onduty,offduty:t.resolve.project.offduty};e.project.update(r,function(){o.success("更新成功"),t.close({$value:r})},o.error)},t.cancel=function(){t.dismiss()}}]});