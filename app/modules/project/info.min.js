"use strict";angular.module("app").component("projectInfo",{templateUrl:"app/modules/project/info.html?rev=8f79bed3dc",controller:["$rootScope","$api","SweetAlert","$state","$uibModal",function(t,r,n,e,c){var i=this;i.currentPage=1,i.pageSize=15,i.$onInit=function(){r.project.info({statistic:!0},function(e){t.Project.length=0,angular.forEach(t.Project,function(e){delete t.Project[e._id]}),angular.forEach(angular.isArray(e.result)?e.result:[e.result],function(e){t.Project.push(e),t.Project[e._id]=e}),t.Project[t.Project.selected._id]||(t.Project.selected=t.Project[0])})},i.DoRemove=function(e,o){i.popover.close(),r.project.delete({id:e},function(){t.Project.splice(i.pageSize*(i.currentPage-1)+o,1),delete t.Project[e]},n.error)},i.statusSwitch=function(o){i.popover.close(),c.open({component:"projectInfoStatusSwitch",resolve:{project:function(){return o}}}).result.then(function(e){angular.extend(o,e)})},i.changeTime=function(o){i.popover.close(),c.open({component:"projectInfoChangeTime",resolve:{project:function(){return o}}}).result.then(function(e){angular.extend(o,e)})},i.popover={field:void 0,target:void 0,openChange:function(e,o){i.originalItem=e,i.popover.target=angular.copy(e),i.popover.field=o},ok:function(){var e={id:i.popover.target._id};e[i.popover.field]=i.popover.target[i.popover.field],r.project.update(e,function(){n.success("更新成功"),i.originalItem[i.popover.field]=i.popover.target[i.popover.field],i.popover.close()},n.error)},close:function(){delete i.popover.field,delete i.popover.target}}}]}),angular.module("app").component("projectInfoStatusSwitch",{templateUrl:"project-info-switch-status.html",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api",function(e){var o=this;o.ok=function(){e.project.status({projectid:o.resolve.project._id,status:"ONLINE"},function(){o.close({$value:{status:"ONLINE"}})})},o.cancel=function(){o.dismiss()}}]}),angular.module("app").component("projectInfoChangeTime",{templateUrl:"project-info-change-time.html",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api","SweetAlert",function(o,t){var r=this;r.ondutyHour=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],r.ondutyMinute=["00","10","20","30","40","50"],r.offdutyHour=angular.copy(r.ondutyHour),r.offdutyMinute=angular.copy(r.ondutyMinute),r.$onInit=function(){r.title=r.resolve.project.title;var e=moment(r.resolve.project.onduty,"HH:mm"),o=moment(r.resolve.project.offduty,"HH:mm");r.ondutyHour.selected=e.format("HH"),r.ondutyMinute.selected=e.format("mm"),r.offdutyHour.selected=o.format("HH"),r.offdutyMinute.selected=o.format("mm")},r.ok=function(){r.resolve.project.onduty=String(r.ondutyHour.selected)+":"+String(r.ondutyMinute.selected),r.resolve.project.offduty=String(r.offdutyHour.selected)+":"+String(r.offdutyMinute.selected);var e={id:r.resolve.project._id,onduty:r.resolve.project.onduty,offduty:r.resolve.project.offduty};o.project.update(e,function(){t.success("更新成功"),r.close({$value:e})},t.error)},r.cancel=function(){r.dismiss()}}]});