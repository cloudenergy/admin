"use strict";angular.module("app").component("projectInfo",{templateUrl:"app/modules/project/info.html?rev=864237e14e",controller:["$rootScope","$api","SweetAlert","$state","$uibModal",function(e,t,o,r,n){var c=this;c.currentPage=1,c.pageSize=15,c.$onInit=function(){t.project.info(function(t){e.Project.length=0,angular.forEach(e.Project,function(t){delete e.Project[t._id]}),angular.forEach(angular.isArray(t.result)?t.result:[t.result],function(t){e.Project.push(t),e.Project[t._id]=t}),e.Project[e.Project.selected._id]||(e.Project.selected=e.Project[0])})},c.DoRemove=function(r,n){c.popover.close(),t.project.delete({id:r},function(){e.Project.splice(c.pageSize*(c.currentPage-1)+n,1),delete e.Project[r]},o.error)},c.statusSwitch=function(e){c.popover.close(),n.open({component:"projectInfoStatusSwitch",resolve:{project:function(){return e}}}).result.then(function(t){angular.extend(e,t)})},c.changeTime=function(e){c.popover.close(),n.open({component:"projectInfoChangeTime",resolve:{project:function(){return e}}}).result.then(function(t){angular.extend(e,t)})},c.popover={field:void 0,target:void 0,ok:function(){var e={id:c.popover.target._id};e[c.popover.field]=c.popover.target[c.popover.field],t.project.update(e,function(){o.success("更新成功"),c.popover.close()},o.error)},close:function(){delete c.popover.field,delete c.popover.target}}}]}),angular.module("app").component("projectInfoStatusSwitch",{templateUrl:"project-info-switch-status.html",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api",function(e){var t=this;t.ok=function(){e.project.status({projectid:t.resolve.project._id,status:"ONLINE"},function(){t.close({$value:{status:"ONLINE"}})})},t.cancel=function(){t.dismiss()}}]}),angular.module("app").component("projectInfoChangeTime",{templateUrl:"project-info-change-time.html",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$api","SweetAlert",function(e,t){var o=this;o.ondutyHour=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],o.ondutyMinute=["00","10","20","30","40","50"],o.offdutyHour=angular.copy(o.ondutyHour),o.offdutyMinute=angular.copy(o.ondutyMinute),o.$onInit=function(){o.title=o.resolve.project.title;var e=moment(o.resolve.project.onduty,"HH:mm"),t=moment(o.resolve.project.offduty,"HH:mm");o.ondutyHour.selected=e.format("HH"),o.ondutyMinute.selected=e.format("mm"),o.offdutyHour.selected=t.format("HH"),o.offdutyMinute.selected=t.format("mm")},o.ok=function(){o.resolve.project.onduty=String(o.ondutyHour.selected)+":"+String(o.ondutyMinute.selected),o.resolve.project.offduty=String(o.offdutyHour.selected)+":"+String(o.offdutyMinute.selected);var r={id:o.resolve.project._id,onduty:o.resolve.project.onduty,offduty:o.resolve.project.offduty};e.project.update(r,function(){t.success("更新成功"),o.close({$value:r})},t.error)},o.cancel=function(){o.dismiss()}}]});