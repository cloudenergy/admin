"use strict";angular.module("app").controller("ChannelSelect",["$scope","$rootScope","$uibModalInstance","$api","ProjectID","SelectedSensors",function(s,e,n,i,a,r){var o;s.currentPage=1,s.project=a,s.popPageSize=8,s.Ok=function(){var i=!0;_.each(s.viewOfSensors,function(n){var e=_.find(r,function(e){return e._id==n._id});i=!1,n.isEnable&&angular.isUndefined(e)&&r.push(n)}),i?s.Cancel():n.close(r)},s.Cancel=function(){n.dismiss("cancel")},s.SwitchSensor=function(e,n){e.preventDefault();var i=_.find(r,function(e){return e._id==n._id});i?r=_.without(r,i):r.push(n),n.isEnable=!n.isEnable},s.onSearchSensor=function(e){e.preventDefault(),s.UpdateViewOfSensors(s.sensorSearchKey)},s.OnSelectAll=function(e){e.preventDefault();for(var n=(s.currentPage-1)*s.popPageSize,i=s.viewOfSensors.length>s.currentPage*s.popPageSize&&s.currentPage*s.popPageSize||s.viewOfSensors.length,a=n;a<i;a++)s.viewOfSensors[a].isEnable=!0},s.UpdateViewOfSensors=function(n){s.viewOfSensors=[],n?_.each(o,function(e){e.title&&e.title.match(n)||e.addrid.match(n)?s.viewOfSensors.push(e):e.channel&&e.channel.match(n)&&s.viewOfSensors.push(e)}):s.viewOfSensors=_.union(s.viewOfSensors,o),_.each(s.viewOfSensors,function(n){var e;e=_.find(r,function(e){return _.isObject(e)?e._id==n._id:e==a+"."+n._id}),n.isEnable=!angular.isUndefined(e)});var i=[];angular.forEach(s.viewOfSensors,function(e){e.isEnable&&i.push(e)}),angular.forEach(s.viewOfSensors,function(e){e.isEnable||i.push(e)}),s.viewOfSensors=i},i.sensorchannel.info({project:a},function(e){o=[],angular.forEach(e.result,function(e){null!=="冷水刻度热水刻度纯水刻度正向有功能量系数总冷量总热量".match(e.channelname)&&(console.log(null!=="冷水刻度热水刻度纯水刻度正向有功能量系数总冷量总热量".match(e.channelname),e.channelname),o.push(e))}),s.UpdateViewOfSensors()}.bind(this))}]);