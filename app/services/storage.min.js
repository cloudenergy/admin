<<<<<<< HEAD
"use strict";angular.module("app").service("$storage",["$cookies","$location",function(o,e){var i=this,r=(e.$$host.split("."),"__emapp_"),a=".manyuenergy.com",s={uid:"",token:""},t=o.getAll(),n=new window.Hashes.SHA1;angular.extend(i,{get:function(e){return"undefined"===(e=i.expired()?void 0:o.get(e)||sessionStorage[r+e]||localStorage[r+e])?void 0:e},set:function(t,n,e){t&&Object.keys(t).length?(e||Object.keys(s).map(function(e){o.put(e,t[e],{path:"/",domain:a,expires:n&&moment().add(1,"M")._d||void 0})}),n?(i.expired(moment().add(1,"M").unix()),Object.keys(s).map(function(e){localStorage[r+e]=t[e]})):(sessionStorage[r+"expires"]="Session",Object.keys(s).map(function(e){sessionStorage[r+e]=t[e]}))):(delete localStorage[r+"expires"],delete sessionStorage[r+"expires"],Object.keys(s).map(function(e){delete localStorage[r+e],delete sessionStorage[r+e],o.remove(e,{path:"/",domain:a})}))},expired:function(e){if(!e||!moment(e,"X"))return!o.get("token")&&(!sessionStorage[r+"expires"]&&(!(e=localStorage[r+"expires"])||moment(e,"X").isBefore(moment())));localStorage[r+"expires"]=e},valid:function(){var t=!0;return Object.keys(s).map(function(e){i.get(e)||(t=!1)}),t},encrypt:function(e){if(i.valid()){var t=moment().unix();e.v=t,e.t=i.get("token"),e.sign=n.hex(function(t,e){var n=[],o=[];return angular.forEach(t,function(e,t){n.push(t)}),n.sort(),angular.forEach(n,function(e){o.push(e+"="+encodeURIComponent(angular.isObject(t[e])?JSON.stringify(t[e]):t[e]))}),e+o.toString().replace(/,/g,"")+e}(e,n.hex(t.toString()))),e.p=i.get("uid"),delete e.t}return e}}),Object.keys(t).length&&i.set(t,!1,!0)}]);
=======
"use strict";angular.module("app").service("$storage",["$cookies","$location",function(e,t){var n=this,o=(t.$$host.split("."),"__emapp_"),i={uid:"",token:""},r=e.getAll(),a=new window.Hashes.SHA1,s=function(e,t){var n=[],o=[];return angular.forEach(e,function(e,t){n.push(t)}),n.sort(),angular.forEach(n,function(t){o.push(t+"="+encodeURIComponent(angular.isObject(e[t])?JSON.stringify(e[t]):e[t]))}),t+o.toString().replace(/,/g,"")+t};angular.extend(n,{get:function(t){return t=n.expired()?void 0:e.get(t)||sessionStorage[o+t]||localStorage[o+t],"undefined"===t?void 0:t},set:function(t,r,a){t&&Object.keys(t).length?(!a&&Object.keys(i).map(function(n){e.put(n,t[n],{path:"/",domain:".manyuenergy.com",expires:r&&moment().add(1,"M")._d||void 0})}),r?(n.expired(moment().add(1,"M").unix()),Object.keys(i).map(function(e){localStorage[o+e]=t[e]})):(sessionStorage[o+"expires"]="Session",Object.keys(i).map(function(e){sessionStorage[o+e]=t[e]}))):(delete localStorage[o+"expires"],delete sessionStorage[o+"expires"],Object.keys(i).map(function(t){delete localStorage[o+t],delete sessionStorage[o+t],e.remove(t,{path:"/",domain:".manyuenergy.com"})}))},expired:function(t){if(!t||!moment(t,"X"))return!e.get("token")&&(!sessionStorage[o+"expires"]&&(!(t=localStorage[o+"expires"])||moment(t,"X").isBefore(moment())));localStorage[o+"expires"]=t},valid:function(){var e=!0;return Object.keys(i).map(function(t){n.get(t)||(e=!1)}),e},encrypt:function(e){if(n.valid()){var t=moment().unix();e.v=t,e.t=n.get("token"),e.sign=a.hex(s(e,a.hex(t.toString()))),e.p=n.get("uid"),delete e.t}return e}}),Object.keys(r).length&&n.set(r,!1,!0)}]);
>>>>>>> 6e3d1a2aa57f97a11542dd09c3d02693cef0d7c3
