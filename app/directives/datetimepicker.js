angular.module("app").directive("datetimepicker",["$timeout","$ocLazyLoad",function($timeout,$ocLazyLoad){var pluginLoad=$ocLazyLoad.load(["vendor/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css?rev=4fe382c5a6","vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js?rev=6055168fe2"]);return{restrict:"A",require:"?ngModel",link:function(scope,element,attrs,ctrl){pluginLoad.then(function(){var linkLeft,linkRight,options={locale:"zh-CN",format:"YYYY-MM-DD",maxDate:new Date,widgetPositioning:{horizontal:"right"}};angular.forEach(element.data(),function(val,key){/^\$/.test(key)||(/^\{.*\}$/.test(val)||/^\[.*\]$/.test(val)?eval("this[key]="+val):this[key]=val)},options),scope.$watch(attrs.datetimepicker,function(e){attrs.datetimepicker&&!angular.isDefined(e)||(angular.isObject(e)&&angular.extend(options,e),linkLeft=options.linkLeft&&$(options.linkLeft),linkRight=options.linkRight&&$(options.linkRight),delete options.linkLeft,delete options.linkRight,element.datetimepicker(options),!options.inline&&$timeout(function(){var e=linkLeft&&linkLeft.length&&linkLeft.data("DateTimePicker"),t=linkRight&&linkRight.length&&linkRight.data("DateTimePicker"),a=element.data("DateTimePicker"),n=function(n,i){e&&(e.maxDate(n),e.date()&&a.minDate(e.date()),i&&e.date(moment(Math.max(moment(n).subtract(i,"days"),e.date())))),t&&(t.minDate(n),t.date()&&a.maxDate(t.date()),i&&t.date(moment(Math.min(moment(n).add(i,"days"),t.date(),moment()))))};element.off("dp.change").on("dp.change",function(e){ctrl&&ctrl.$setViewValue(e.target.value),n(e.date,attrs.rangeDay&&scope.$eval(attrs.rangeDay))}).off("dp.show").on("dp.show",function(e){(element.is("input")?element.parent():element).addClass("focus"),n(a.date(),attrs.rangeDay&&scope.$eval(attrs.rangeDay))}).off("dp.hide").on("dp.hide",function(){(element.is("input")?element.parent():element).removeClass("focus")})}))})})}}}]);